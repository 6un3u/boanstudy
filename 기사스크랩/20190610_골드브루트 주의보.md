# 골드브루트(Gold Brute) 주의보

<br>

### 1. 기사요약

+ 블루킵과 마찬가지로 RDP와 관련된 공격

+ 공격 난이도는 훨씬 낮음
+ 현재도 진행 중인 골드브루트 공격
+ 봇넷의 규모는 시시각각 커지는 중
+ 취약한 RDP 검색해 시스템 장악하는 공격

<br>

### 2. 골드브루트(Gold Brute) 

- 원격 데스크톱 프로토콜(RDP)을 통한 연결을 방해하려는 브루트 포스 공격이 이어짐
- 인터넷을 스캔해 RDP가 노출된 시스템을 적극 찾고 있음
- 발견한 후에는 디폴트 비밀번호나 자신들이 이미 확보한 비밀번호를 대입하면서 시스템에 접근하고 있음
- 최초 발견 이후 6시간이 지났을 무렵, C&C 서버에는 IP주소가 210만개가 저장돼 있었음
- 이 중 160만개 정도가 고유한 주소였고, 나머지는 중복되는 것이었음
- 취약한 RDP에 브루트 포스 공격을 함으로써 침해된 시스템들은 봇넷에 편입됨
- RDP를 통해 접근하는데 성공하면 정상 사용자가 할 수 있는 모든 일을 할 수 있음
  - 회사 네트워크게 접속, 멀웨어를 심고, 정보를 훔치고, CPU를 악의적인 목적으로사용하는 게 전부 가능해 짐
- 공격을 통제하는 C&C 서버는 봇들과 데이터를 주고받는데, 이 때 AES로 암호화 된 웹소켓 연결 방식을 사용함(AES 암호화 : 암호화와 복호화 과정에서 동일한 키를 사용하는 대칭 키 알고리즘)
- 포트는 8333이 사용됨

<br>

### 2.1 골드브루트 공격방법

- 감염된 시스템은 제일 먼저 봇 코드(bot code)라는 걸 다운로드 받음
- 봇 코드는 80MB짜리 대형 패키지로 자바 런타임(JAVA Runtime)을 포함하고 있음
- 봇 코드는 호스트에 설치된 이후 무작위로 IP 주소들을 스캔하기 시작함
- 감염 가능한 호스트를 찾아내고 C&C 서버에 그 사실을 알림
- C&C 서버에 알린 호스트의 수가 80개가 되면 C&C 서버에서 브루트 포스 공격을 하라는 명령이 떨어짐
- 80개가 될 때마다 새로운 표적들이 정해지기도 함
- 모든 봇들이 브루트 포스 공격에 참여하는데 봇 하나당 한개의 사용자 이름과 비밀번호를 대입
- 무작위 대입 시 발생하는 트래픽을 줄임으로써 탐지에 걸리지 않게 하기 위해서임
- RDP를 인터넷에 불필요하게 노출시키지 말고 VPN을 사용하면 방어가 가능

<br>

### 3. 알아 둘 용어

<br>

#### 3.1 RDP(Remote Desktop Protocol)

+ 원격 데스크톱 프로토콜(RDP,Remote Desktop Protocol)

+ 마이크로소프트사의 터미널 서버와 터미널 서버 클라이언트 단의 통신에 사용되는 다중채널 프로토콜

+ 기술 자원과 IT 관리를 목적으로 널리 사용되고 있음

+ 기본적으로 TCP 포트 3389를 사용
+ 몇 년 전부터 취약한 패스워드를 사용하는 보안이 약한 RDP 서버를 직접 공격하고, 이를 매개로 네트워크에 침투하여 랜섬웨어와 같은 악성코드 유포가 이루어지고 있음
+ 인터넷에 노출된 RDP 서버는 외부에서 공격자들이 브루트포스(Brute Force)공격을 시도하여 모니터링 및 임의 조작을 할 수 있으므로 필요치 않은 RDP 서버에 대한 관리가 필요함

<br>

#### 3.2 BlueKeep(CVE-2019-0708) 

+ 윈도우 원격 터미널 접속에 사용하는 마이크로소프트의 RDP(Remote Desktop Protocol)에서 원격코드실행 취약점이 발견됨

+ 블루킵의 가장 큰 특징은 '워머블'
+ 워머블이란, 웜처럼 증식한다는 것으로 멀웨어 공격자들이 이를 활용할 경우 효율 높은 감염률을 기록할 수 있게 됨
+ 대표적인 예 : 워너크라이 랜섬웨어(WannaCry Ransomware), 워너크라이는 당시 워머블 취약점의 일종이었던 이터널블루를 악용했음
+ 블루킵의 경우, 공격자는 인증 단계를 거칠 필요 없이, 특수하게 조작된 요청을 원격 데스크톱 프로토콜(RDP)을 통해 공격 표적 시스템에 전송함으로써 임의의 코드를 실행하고 장비의 통제권을 가져올 수 있게 됨
+ 보안업체 에라타 시큐리티의 로버트 그래함은 최근 매스스캔(masscan) 포트 스캐너와 알디피스캔(rdpscan)을 사용해 인터넷을 스캔한 결과 92만 3천여개의 장비가 블루킵 공격에 노출되어 있는 것을 발견했음

<br>

#### 3.2.1 블루킵에 영향을 받는 제품

+ Windows XP
+ Windows 7
+ Windows Server 2003, 2008 및 2008 R2
+ 윈도우 8, 10은 영향을 받지 않음

+ 더 자세한 내용은 [여기](https://www.krcert.or.kr/data/secNoticeView.do?bulletin_writing_sequence=35028)를 클릭하세요.

<br>

#### 3.2.2 해결방안

+ 영향 받는 제품의 이용자는 윈도우 자동/수동 업데이트를 이용하여 최신 버전으로 설치
+ 수동 설치가 필요한 경우 [여기](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708)에 접속하여 "Security Updates"의 하단 표에 있는 Download 링크를 클릭하여 설치 적용
+ 윈도우 XP, 2003 서버 사용자의 경우 [여기](https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708 )에 접속하여 보안 업데이트 파일 다운로드 및 설치 적
+ 허용한 관리자만 윈도우 RDP를 접근할 수 있도록 방화벽 등을 통한 접근 통제 강화
+ 패치를 적용하지 못하는 제품은 NLA를 활성화하고 TCP 포트 3389를 차단

<br>

---

#### 참조글

-[ESTsecurity / RDP 정의](https://www.estsecurity.com/securityCenter/commonSense/view/1508)

-[KISA 인터넷보호나라&KrCERT / 블루킵 정의 및 대응방안](https://www.krcert.or.kr/data/secNoticeView.do?bulletin_writing_sequence=35028)

-[보안뉴스 / 블루킵 관련 기사 : 윈도우 RDS 취약점 ‘블루킵’, 해커들의 관심 높아지고있어](https://www.boannews.com/media/view.asp?idx=79971&page=1&kind=1) / 2019-05-29

-[보안뉴스 / 골드브루트 관련 기사 : 어쩌면 블루킵보다 더 심각한 문제? 골드브루트 주의보](https://www.boannews.com/media/view.asp?idx=80248&kind=) / 2019-06-10





